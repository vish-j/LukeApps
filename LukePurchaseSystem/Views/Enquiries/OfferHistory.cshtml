@model LukeApps.GeneralPurchase.ViewModel.Offer
@section CustomStyles {
    @Styles.Render("~/Content/dt-basic")
    
}
@{
    ViewBag.Title = "Offer History";
}

<h2>History of Offer @Model.OfferID</h2>

<table id="dtTable" class="table table-striped table-bordered" width="100%">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.OfferID)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Company)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Revision)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.VendorResponse)
            </th>            
            <th>
                @Html.DisplayNameFor(model => model.BidReceivedDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.TotalPriceQuoted)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ExpiryDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.InitialPaymentTerms)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IsTermsConditionsAgreed)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DeviationsInTermsAndConditions)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IsPaymentTermsAgreed)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.AgreedPaymentTerms)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Milestones)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ScheduleExecution)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IsTechnicallyAcceptable)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IsCommerciallyAcceptable)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.AuditDetail.CreatedDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.AuditDetail.CreatedEntryUser)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.AuditDetail.LastModifiedDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.AuditDetail.LastModifiedEntryUser)
            </th>
        </tr>
    </thead>

    <tfoot>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.OfferID)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Company)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Revision)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.VendorResponse)
            </th>   
            <th>
                @Html.DisplayNameFor(model => model.BidReceivedDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.TotalPriceQuoted)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ExpiryDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.InitialPaymentTerms)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IsTermsConditionsAgreed)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DeviationsInTermsAndConditions)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IsPaymentTermsAgreed)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.AgreedPaymentTerms)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Milestones)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ScheduleExecution)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IsTechnicallyAcceptable)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IsCommerciallyAcceptable)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.AuditDetail.CreatedDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.AuditDetail.CreatedEntryUser)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.AuditDetail.LastModifiedDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.AuditDetail.LastModifiedEntryUser)
            </th>
        </tr>
    </tfoot>
</table>

<div>
    @Html.ActionLink("Back to Enquiry", "Index", new { id = Model.EnquiryID })
</div>

<div id="viewModal" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">Summary</h4>
            </div>
            <div class="modal-body">
                <div id="viewContainer" style="min-height:200px">
                    <div id="spinner">
                        <span>Loading Details</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts{
    @Scripts.Render("~/bundles/datatables")
    @Scripts.Render("~/bundles/indexHelper")

    @if (@ViewBag.ModalID != null)
    {
        <script type="text/javascript">
            $(document).ready(function () {
                showmodal(@ViewBag.ModalID)
            });
        </script>
    }

    <script type="text/javascript">

        var rootURL = '@Html.Raw(@Url.Action("/", new { latestid = Model.OfferID, a = "OfferHistory" }))';

        IndexConfig.ModalDetailPage = 'OfferDetails';
        IndexConfig.dtConfig.ajax = '@Url.Action("OfferHistorygetJSON", new { latestid = Model.OfferID })';
        IndexConfig.dtConfig.columns = [
                    { "data": "OfferNumber" },
                    { "data": "Company" },
                    { "data": "Revision" },
                    { "data": "VendorResponse" },
                    { "data": "BidReceivedDate" },
                    { "data": "TotalPriceQuoted" },
                    { "data": "ExpiryDate" },
                    { "data": "InitialPaymentTerms" },
                    { "data": "IsTermsConditionsAgreed" },
                    { "data": "DeviationsInTermsAndConditions" },
                    { "data": "IsPaymentTermsAgreed" },
                    { "data": "AgreedPaymentTerms" },
                    { "data": "Milestones" },
                    { "data": "ScheduleExecution" },
                    { "data": "IsTechnicallyAcceptable" },
                    { "data": "IsCommerciallyAcceptable" },
                    { "data": "CreatedDate" },
                    { "data": "CreatedEntryUser" },
                    { "data": "LastModifiedDate" },
                    { "data": "LastModifiedEntryUser" },
        ];

        IndexConfig.dtConfig.rowCallback = function (row, data, index) {
                $('td:eq(0)', row).html('<a class="btn btn-primary btn-sm" onClick="showmodal(\'' + data.OfferNumber + '\')" data-toggle="tooltip" data-placement="bottom" title="View" data-animation="true"><span class="glyphicon glyphicon-eye-open"></span>  <b>' + data.OfferNumber + '</b></a>');
        }


        //Define Table
        var table = $('#dtTable').DataTable(IndexConfig.dtConfig);

        $('#dtTable_wrapper').on('draw.dt', function () {
            $('[data-toggle="tooltip"]').tooltip();
        });

    </script>

    @Scripts.Render("~/bundles/dt-button")
}